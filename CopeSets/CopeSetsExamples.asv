%% 2D ramp
dim = [100 100]; 
sig = repmat(linspace(1, 3), dim(2), 1);
nsubj = 60;
FWHM = 3;
c = 2;
lvls = 0.90;
nsim = 1000;

for I = 1:nsim
    noise = noisegen( dim, nsubj, FWHM );
    data = noise + sig;
    data = Field(data, true(dim)); % convert to field
    [ thresh_tmp, quantiles_tmp, hatmu_tmp, hatsigma_tmp, len_bdry_tmp ] = ...
                            CopeSets( data, c, lvls );
end